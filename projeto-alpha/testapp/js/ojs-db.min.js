/**
 * @license
 * Copyright (c) 2016 Alan Thales.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * You may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *    http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var ArrayMap=function(){function t(){var r=[];return r=Array.apply(r,arguments)||r,r.__proto__=t.prototype,r.mapTable=function(t){return this.map(function(e){return e[t]})},r.indexOfKey=function(t,e){return this.mapTable(t).indexOf(e)},r.put=function(t,e){var n=e||this.length;this[n]=t},r.putRange=function(t,e){if(t&&t instanceof Array){var n,r=e&&"boolean"==typeof e?this.length:0,o=t.length;for(n=0;o>n;n++)this.put(t[n],r+n)}},r.query=function(n){var r=this,o=n&&"object"==typeof n?n:{},i=new t;return i.putRange(r.filter(function(t){return e.call(r,t,o)})),i},r.orderBy=function(t){var e,n=t&&"object"==typeof t?t:{},r=function(t,e){return"string"==typeof t?t.localeCompare(e):(t>e)-(e>t)},o=function(t,e){return"string"==typeof e?e.localeCompare(t):(e>t)-(t>e)};return this.sort(function(t,i){var a=0;for(e in n){if(t[e]!=i[e]){a="desc"===n[e]?o(t[e],i[e]):r(t[e],i[e]);break}a=0}return a}),this},r.groupBy=function(r,o,i){var a,s,c,u=this,p=new t,f=i&&"object"==typeof i?i:{},h=o.length,l={};return u.forEach(function(t){if(e.call(u,t,f)){for(s={},c=0;h>c;c++)s[o[c]]=t[o[c]];a=JSON.stringify(s),l[a]=l[a]||[],l[a].push(t)}}),p.putRange(Object.keys(l).map(function(t){return s=JSON.parse(t),n(l[t],r,s)})),p},r.compute=function(t){return n(this,t)},r}var e=function(t,e){var n,r,o,i=!0;if(e.$custom&&"function"==typeof e.$custom)return e.$custom.call(this,t);for(n in e){if(!i)break;if("object"==typeof e[n]){o=t[n].toString();for(r in e[n]){switch(r){case"$gt":i=t[n]>e[n][r];break;case"$gte":i=t[n]>=e[n][r];break;case"$lt":i=t[n]<e[n][r];break;case"$lte":i=t[n]<=e[n][r];break;case"$start":i=0===o.lastIndexOf(e[n][r],0);break;case"$end":i=-1!==o.indexOf(e[n][r],o.length-e[n][r].length);break;case"$contain":i=o.indexOf(e[n][r])>-1;break;case"$in":i=e[n][r].indexOf(t[n])>-1;break;default:i=!1}if(!i)break}}else i=t[n]==e[n]}return i},n=function(t,e,n){var r,o,i,a=e&&e instanceof Array?e:[e],n=n||{};return a.forEach(function(e){for(r in e)break;switch(o=e[r],i=e.alias||o,r){case"$max":t.sort(function(t,e){return e[o]-t[o]}),n[i]=t[0][o];break;case"$min":t.sort(function(t,e){return t[o]-e[o]}),n[i]=t[0][o];break;case"$sum":n[i]=t.map(function(t){return t[o]}).reduce(function(t,e){return parseFloat(t)+parseFloat(e)},0);break;case"$avg":n[i]=t.map(function(t){return t[o]}).reduce(function(t,e){return parseFloat(t)+parseFloat(e)},0),n[i]/=t.length;break;case"$count":n[i]=t.length}}),n};return t.prototype=Object.create(Array.prototype),t}(),OjsUtils=function(){var t=function(t){for(var e,n=new Array(t),r=0;t>r;r++)0==(3&r)&&(e=4294967296*Math.random()),n[r]=e>>>((3&r)<<3)&255;return n},e=function(t){function e(t){return i[t>>18&63]+i[t>>12&63]+i[t>>6&63]+i[63&t]}var n,r,o,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=t.length%3,s="";for(o=0,r=t.length-a;r>o;o+=3)n=(t[o]<<16)+(t[o+1]<<8)+t[o+2],s+=e(n);switch(a){case 1:n=t[t.length-1],s+=i[n>>2],s+=i[n<<4&63],s+="==";break;case 2:n=(t[t.length-2]<<8)+t[t.length-1],s+=i[n>>10],s+=i[n>>4&63],s+=i[n<<2&63],s+="="}return s};return{uid:function(n){return e(t(Math.ceil(Math.max(8,2*n)))).replace(/[+\/]/g,"").slice(0,n)},cloneObject:function(t){var e,n,r;if(!t||t instanceof Date||t instanceof SimpleDataSet)return t;if(t instanceof ArrayMap&&(e=new ArrayMap),"[object Array]"===Object.prototype.toString.call(t)){for(e=e||[],n=0,r=t.length;r>n;n++)e[n]=this.cloneObject(t[n]);return e}if("object"==typeof t){e={};for(n in t)t.hasOwnProperty(n)&&(e[n]=this.cloneObject(t[n]));return e}return t},cloneProperties:function(t,e){for(var n in t)e[n]=t[n]}}}(),ChildRecord=function(){function t(t,e){var n=t,r=e;this.getDtsMaster=function(){return n},this.getRecMaster=function(){return r}}return t.prototype.notifyMaster=function(){this.getDtsMaster().save(this.getRecMaster())},t}(),SimpleDataSet=function(){function t(){this._inserteds=[],this._updateds=[],this._deleteds=[],this._copy=null,this._lastOp=null,this.sort=null,this.data=new ArrayMap}return t.prototype._cleanCache=function(){this._inserteds.length=0,this._updateds.length=0,this._deleteds.length=0,this._copy=null,this._lastOp=null},t.prototype.getById=function(t){var e=this.data.indexOfKey("id",t);return this.data[e]},t.prototype.insert=function(t){t.id||(t.id=(new Date).getTime());var e=this.data.indexOfKey("id",t.id);return-1===e&&(this._inserteds.push(t),this.data.push(t)),this._copy=OjsUtils.cloneObject(t),this._lastOp="insert",t instanceof ChildRecord&&t.notifyMaster(),this},t.prototype.update=function(t){if(t.id){var e=this.data.indexOfKey("id",t.id);return this._updateds[e]?this._updateds.splice(e,1,t):this._updateds.push(t),this._copy=OjsUtils.cloneObject(this.data[e]),this._lastOp="update",this.data.splice(e,1,t),t instanceof ChildRecord&&t.notifyMaster(),this}},t.prototype.save=function(t){return t?t.id?this.update(t):this.insert(t):void 0},t.prototype["delete"]=function(t){if(t.id){var e=this.data.indexOfKey("id",t.id);return this._deleteds[e]||this._deleteds.push(t),this._copy=OjsUtils.cloneObject(this.data[e]),this._lastOp="delete",this.data.splice(e,1),t instanceof ChildRecord&&t.notifyMaster(),this}},t.prototype.refresh=function(){var t=this;return t.sort&&t.data.orderBy(t.sort),t},t.prototype.insertAll=function(t){var e=this;!t instanceof Array||t.forEach(function(t){e.insert(t)})},t.prototype.clear=function(){return this.data.length=0,this._cleanCache(),this},t.prototype.cancel=function(){if(this._copy){var t=this.data.indexOfKey("id",this._copy.id);switch(this._lastOp){case"insert":this.data.splice(t,1),this._inserteds.pop();break;case"update":this.data.splice(t,1,this._copy),this._updateds.pop();break;case"delete":this.data.push(this._copy),this._deleteds.pop()}}},t}(),DataSet=function(){function t(t,e,n,r){var o=t,i=e,a=r;this.active=!1,this.limit=1e3,this.params=null,this.genId=n,this.getProxy=function(){return o},this.getTable=function(){return i},this.getSyncronizer=function(){return a},SimpleDataSet.apply(this)}return t.prototype=Object.create(SimpleDataSet.prototype),t.prototype.open=function(t){function e(t,e){"function"==typeof e&&e(t)}var n=this,r={key:n.getTable(),limit:n.limit,sort:n.sort,params:n.params};return n.active?(e(n.data,t),n):(n.getProxy().getRecords(r,function(r){n.data=r,n.active=!0,e(r,t)}),n)},t.prototype.close=function(){return SimpleDataSet.prototype.clear.apply(this,arguments),this.active=!1,this},t.prototype.insert=function(t){if(!this.active)throw"Invalid operation on closed dataset";SimpleDataSet.prototype.insert.apply(this,arguments)},t.prototype.update=function(t){if(!this.active)throw"Invalid operation on closed dataset";SimpleDataSet.prototype.update.apply(this,arguments)},t.prototype["delete"]=function(t){if(!this.active)throw"Invalid operation on closed dataset";SimpleDataSet.prototype["delete"].apply(this,arguments)},t.prototype.post=function(t,e){function n(){i&&!e&&i.writeData(r.getTable(),r._inserteds,r._updateds,r._deleteds),r.refresh(),r._cleanCache(),o()}if(!this.active)throw"Invalid operation on closed dataset";var r=this,o="function"==typeof t?t:function(){},i=this.getSyncronizer();return r._inserteds.length||r._updateds.length||r._deleteds.length?void r.getProxy().commit(r.getTable(),r._inserteds,r._updateds,r._deleteds,n):o()},t.prototype.sync=function(t){var e=this,n=this.getSyncronizer();n&&n.exec(e.getTable(),function(n){var r=new ArrayMap,o=new ArrayMap;r.putRange(n),o.putRange(e.data),o.forEach(function(t){r.indexOfKey("id",t.id)<0&&e["delete"](t)}),r.forEach(function(t){e.data.indexOfKey("id",t.id)<0?e.insert(t):e.update(t)}),e.post(t,!0)})},t.prototype.fetch=function(t,e){if(!this.active)throw"Invalid operation on closed dataset";return this.getProxy().fetch(this.getTable(),this,t,e),this},t}(),DbProxies=function(){return{LOCALSTORAGE:0,SQLITE:1,RESTFUL:2}}(),DbProxy=function(){function t(){this.mappings={}}return t.prototype.createDatabase=function(t,e){this.mappings=t},t.prototype.getRecords=function(t,e){},t.prototype.commit=function(t,e,n,r,o){},t.prototype.fetch=function(t,e,n){},t.dateParser=function(t,e){var n,r=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*))(?:Z|(\+|-)([\d|:]*))?$/;return"string"==typeof e&&(n=r.exec(e))?new Date(e):e},t}(),LocalStorageProxy=function(){function t(){DbProxy.apply(this,arguments)}var e=function(t){var e="object"==typeof t?t.key:t,n=window.localStorage[e],r=new ArrayMap;return n&&r.putRange(JSON.parse(n,DbProxy.dateParser)),r.length&&t.params?r.query(t.params):r},n=function(t,e,n){window.localStorage[t]=JSON.stringify(e),"function"==typeof n&&n()};return t.prototype=Object.create(DbProxy.prototype),t.prototype.getRecords=function(t,n){var r=e(t);t.sort&&r.orderBy(t.sort),"function"==typeof n&&n(r)},t.prototype.query=function(t,n,r){var o=e(t),i=o.query(n);r(i)},t.prototype.groupBy=function(t,n,r,o,i){var a=e(t);i(a.groupBy(n,r,o))},t.prototype.save=function(t,r,o){var i=e(t),a=i.indexOfKey("id",r.id);-1===a?i.push(r):i.splice(a,1,r),n(t,i,o)},t.prototype.remove=function(t,r,o){var i="object"==typeof r?r.id:r,a=e(t),s=a.indexOfKey("id",i);a.splice(s,1),n(t,a,o)},t.prototype.commit=function(t,e,n,r,o){function i(){u--,0===u&&p()}var a,s=this,c=e.concat(n),u=c.length+r.length,p=o&&"function"==typeof o?o:function(){};if(0===u)return p();for(a=0;a<c.length;a++)s.save(t,c[a],i);for(a=0;a<r.length;a++)s.remove(t,r[a],i)},t}(),SQLiteProxy=function(){function t(t){var e;e=window.cordova&&window.sqlitePlugin?window.sqlitePlugin.openDatabase({name:t}):window.openDatabase(t,"SQLite Database","1.0",5242880),this.getDb=function(){return e},DbProxy.apply(this,arguments)}var e="SELECT * FROM",n={};t.prototype=Object.create(DbProxy.prototype),t.prototype.createDatabase=function(t,e){var r=this,o=null;DbProxy.prototype.createDatabase.apply(this,arguments),n=OjsUtils.cloneObject(t),r.getDb().transaction(function(t){function r(){f--,0===f&&p(o)}var i,a,s,c,u,p=e&&"function"==typeof e?e:function(){},f=Object.keys(n).length;for(s in n){i="";for(c in n[s])a=n[s][c],a.hasMany||(a.hasOne&&(a.type=n[a.hasOne].id.type),i+=[c,a.type,a.required?"NOT NULL":"",a.primaryKey?"PRIMARY KEY":"",","].join(" "));i=i.substr(0,i.length-1),u=["CREATE TABLE IF NOT EXISTS",s,"(",i,")"].join(" "),t.executeSql(u,[],r,function(t){o=t,r()})}})};var r=function(t,e){var r,o,i,a={};for(r in n[t])o=e[r],i=n[t][r],("date"===i.type||"datetime"===i.type)&&(o=new Date(o)),a[r]=o;return a},o=function(t,e,r){var o=n[t][e],i=r[e];return!o||o.hasMany?null:(o.hasOne&&r instanceof ChildRecord&&(i=r.getRecMaster().id),i)},i=function(t,e,n,o,i){var a,s,c,u=new ArrayMap;o.executeSql(e,n,function(e,n){for(s=n.rows.length,a=0;s>a;a++)c=r(t,n.rows.item(a)),u.push(c);"function"==typeof i&&i(u)})},a=function(t){var e,n=[];for(e in t)n.push(e+t[e]);return"ORDER BY "+n.join(",")};t.prototype.getRecords=function(t,n){var r,o=this,s=t&&t.key?t.key:t,c=t&&t.sort?a(t.sort):"",u="WHERE ",p=[];if("object"==typeof t){if(p=[e,t.key],t.params){for(r in t.params)u+=r+" = "+t.params[r];p.push(u)}p.push(c),t.limit&&p.push("LIMIT "+t.limit)}else p=[e,t];o.getDb().transaction(function(t){i(s,p.join(" "),[],t,n)})};var s=function(t,e){var n,r,o="";for(n in e)for(r in e[n])switch(r){case"$gt":o+=[n,">",e[n][r]].join(" ")+" AND ";break;case"$gte":o+=[n,">=",e[n][r]].join(" ")+" AND ";break;case"$lt":o+=[n,"<",e[n][r]].join(" ")+" AND ";break;case"$lte":o+=[n,"<=",e[n][r]].join(" ")+" AND ";break;case"$start":o+=[n," LIKE '",e[n][r],"%'"].join("")+" AND ";break;case"$end":o+=[n," LIKE '%",e[n][r],"'"].join("")+" AND ";break;case"$contain":o+=[n," LIKE '%",e[n][r],"%'"].join("")+" AND ";break;case"$in":o+=[n," IN (",e[n][r].join(","),")"].join("")+" AND ";break;case"$custom":o+=e[n][r].call(e[n][r],n)+" AND ";break;default:o+=""}return""===o?t:(o=o.trim().slice(0,-3),[t,"WHERE",o].join(" "))},c=function(t,n,r,o){var i,a,c,u=n&&n instanceof Array?n:[n],p=r.length?r.join(",")+", ":"",f=o&&"object"==typeof o?s("",o):"",h="";return u.forEach(function(t){for(i in t)break;switch(a=t[i],c=t.alias||a,i){case"$max":h+=["MAX(",a,")"," AS ",c].join("")+", ";break;case"$min":h+=["MIN(",a,")"," AS ",c].join("")+", ";break;case"$sum":h+=["SUM(",a,")"," AS ",c].join("")+", ";break;case"$avg":h+=["AVG(",a,")"," AS ",c].join("")+", ";break;case"$count":h+=["COUNT(",a,")"," AS ",c].join("")+", "}}),""===h?[e,t].join(" "):(h=h.trim().slice(0,-1),h=["SELECT",p,h,"FROM",t,f].join(" "),""===p?h:h+" GROUP BY "+p)};t.prototype.query=function(t,n,r){var o=this,a=n&&"object"==typeof n?n:{},c=[e,t].join(" "),u=s(c,a);o.getDb().transaction(function(e){i(t,u,[],e,r)})},t.prototype.groupBy=function(t,e,n,r,o){var a=this,s=c(t,e,n,r);a.getDb().transaction(function(e){i(t,s,[],e,o)})};var u=function(t,e,r,o,i){function a(n,a){a&&a.message&&console.error(a),p--,0===p&&(u&&u instanceof SimpleDataSet&&u._cleanCache(),o(t,e,r,i))}var s,c,u,p=1;for(s in e)c=n[t][s],c&&c.hasMany&&(u=e[s],u instanceof SimpleDataSet&&(p+=u._inserteds.length+u._updateds.length+u._deleteds.length,u._inserteds.length&&this.insert(c.hasMany,u._inserteds,r,a),u._updateds.length&&this.update(c.hasMany,u._updateds,r,a),u._deleteds.length&&this["delete"](c.hasMany,u._deleteds,r,a)));a()},p=function(t,e){var r,i,a,s=[],c="",u="";for(r in n[t])a=o(t,r,e),a&&(s.push(a),c+=r+",",u+="?,");return c=c.substr(0,c.length-1),u=u.substr(0,u.length-1),i=["INSERT INTO",t,"(",c,") VALUES (",u,")"].join(" "),{sql:i,params:s}},f=function(t,e,n,r){var o=p(t,e);n.executeSql(o.sql,o.params,r,r)};t.prototype.insert=function(t,e,n,r){var o=e.length,i=0;if(0===o)return r();for(;o>i;i++)u.call(this,t,e[i],n,f,r)};var h=function(t,e){var r,i,a,s=[],c="id = "+e.id,u="";for(i in n[t])"id"!=i&&(a=o(t,i,e),a&&(s.push(a),u+=i+" = ?,"));return u=u.substr(0,u.length-1),r=["UPDATE",t,"SET",u,"WHERE",c].join(" "),{sql:r,params:s}},l=function(t,e,n,r){var o=h(t,e);n.executeSql(o.sql,o.params,r,r)};t.prototype.update=function(t,e,n,r){var o=e.length,i=0;if(0===o)return r();for(;o>i;i++)u.call(this,t,e[i],n,l,r)};var d=function(t,e,r,o){function i(e,n){n&&n.message&&console.error(n),p--,0===p&&(a=["DELETE FROM",t,"WHERE","id =",u].join(" "),r.executeSql(a,[],o,o))}var a,s,c,u="object"==typeof e?e.id:e,p=1;for(s in e)c=n[t][s],c&&c.hasMany&&(p++,a=["DELETE FROM",c.hasMany,"WHERE",c.foreignKey,"=",u].join(" "),r.executeSql(a,[],i,i),e[s]instanceof SimpleDataSet&&e[s].clear());i()};t.prototype["delete"]=function(t,e,n,r){var o=e.length,i=0;if(0===o)return r();for(;o>i;i++)d.call(this,t,e[i],n,r)},t.prototype.commit=function(t,e,n,r,o){function i(t){s--,t&&u.push(t),0===s&&c(u.length?u:null)}var a=this,s=e.length+n.length+r.length,c=o&&"function"==typeof o?o:function(){},u=[];return e.length||n.length||r.length?void a.getDb().transaction(function(o){e.length&&a.insert(t,e,o,i),n.length&&a.update(t,n,o,i),r.length&&a["delete"](t,r,o,i)}):c()};var y=function(t,e,r,o,i){var a,s,c={params:{}},u=n[t][o],p=0;u&&u.hasMany?(c.key=u.hasMany,c.params[u.foreignKey]=r.id,this.getRecords(c,function(t){for(r[o]=new SimpleDataSet,a=t.length;a>p;p++)s=new ChildRecord(e,r),OjsUtils.cloneProperties(t[p],s),r[o].data.push(s);i()})):i()};return t.prototype.fetch=function(t,e,n,r){function o(){a--,0===a&&i()}for(var i="function"==typeof r?r:function(){},a=e.data.length,s=0;a>s;s++)y.call(this,t,e,e.data[s],n,o)},t}(),RestProxy=function(){function t(t){throw console.log(JSON.stringify(t)),t.responseText}function e(t,e){this.config=t,e&&"function"==typeof e?this.serialize=e:this.serialize=n,DbProxy.apply(this,arguments)}var n=function(t){return JSON.stringify(t)},r=function(t,e,n,r,o){var i,a,s,c=new XMLHttpRequest;if(c.onreadystatechange=function(){4===c.readyState&&(i=200===c.status?r:o)(c)},"object"==typeof n){s=n.data;for(a in n.headers)c.setRequestHeader(a,n.headers[a])}c.open(e,t,!0),c.send(s)},o=function(t,e,n){var o,i="object"==typeof t?t:{key:t},a=this.config.url+"/"+i.key,s=new ArrayMap;if(i.params)for(o in i.params)a+="/"+o+"/"+i.params[o];r(a,"GET",this.config,function(t){s.putRange(JSON.parse(t.responseText,DbProxy.dateParser)),e(s)},n)},i=function(t,e,n,o,i){var a=this.config.url+"/"+e,s={data:this.serialize(n)};"PUT"===t&&(a+="/"+n.id),this.config.headers&&(s.headers=this.config.headers),r(a,t,s,function(t){"function"==typeof callback&&o(t)},i)};return e.prototype=Object.create(DbProxy.prototype),e.prototype.getRecords=function(e,n){o(e,function(t){"object"==typeof e&&e.sort&&t.orderBy(e.sort),n(t)},t)},e.prototype.query=function(e,n,r){o(e,function(t){var e=t.query(n);r(e)},t)},e.prototype.groupBy=function(e,n,r,i,a){o(e,function(t){var e=t.groupBy(r,i,n);a(e)},t)},e.prototype.insert=function(e,n,r){i("POST",e,n,r,t)},e.prototype.update=function(e,n,r){i("PUT",e,n,r,t)},e.prototype["delete"]=function(t,e,n){var o=this.config.url+"/"+t+"/"+e.id,i={};this.config.headers&&(i.headers=this.config.headers),r(o,"DELETE",i,function(t){"function"==typeof n&&success(t)},error)},e.prototype.commit=function(t,e,n,r,o){function i(){return c--,0===c?void u():void 0}var a,s=this,c=e.length+n.length+r.length,u=o&&"function"==typeof o?o:function(){};if(0===c)return u();for(a=0;a<e.length;a++)s.insert(t,e[a],i);for(a=0;a<n.length;a++)s.update(t,n[a],i);for(a=0;a<r.length;a++)s["delete"](t,r[a],i)},e}(),SyncDb=function(){function t(){}var e={Insert:"_inserted",Update:"_updated",Delete:"_deleted"},n=function(t,e){return["sync_",e,t].join("")},r=function(t,e,r){var o=n(t,e);window.localStorage[o]=JSON.stringify(r)},o=function(t,e){var r=n(t,e),o=window.localStorage[r],i=new ArrayMap;return o&&i.putRange(JSON.parse(o,DbProxy.dateParser)),i},i=function(t,e){for(var n=new ArrayMap,r=t.concat(e),o=0,i=r.length;i>o;o++)n.indexOfKey("id",r[o].id)<0&&n.put(r[o]);return n};return t.prototype.writeData=function(t,n,a,s){var c=o(e.Insert,t),u=o(e.Update,t),p=o(e.Delete,t);c=i(c,n),u=i(u,a),p=i(p,s),r(e.Insert,t,c),r(e.Update,t,u),r(e.Delete,t,p)},t.prototype.cleanData=function(t){r(e.Insert,t,[]),r(e.Update,t,[]),r(e.Delete,t,[])},t.prototype.sendData=function(t,e,n,r,o){"function"==typeof o&&o()},t.prototype.getNews=function(t,e){"function"==typeof e&&e([])},t.prototype.exec=function(t,n){var r=this,i=n||function(){};r.sendData(t,o(e.Insert,t),o(e.Update,t),o(e.Delete,t),function(){r.cleanData(t),r.getNews(t,i)})},t}(),IdGenerators=function(){return{TIMESTAMP:function(){return(new Date).getTime()},UUID:OjsUtils.uid}}(),DbFactory=function(){function t(t,e,n){var r,o=n;if(this.getProxy=function(){return r},this.getSynchronizer=function(){return o},t&&"object"==typeof t)return void(r=t);switch(t){case 0:r=new LocalStorageProxy;break;case 1:r=new SQLiteProxy(e);break;case 2:r=new RestProxy(e);break;default:throw"Proxy not implemented"}}return t.prototype.createDatabase=function(t,e){this.getProxy().createDatabase(t,e)},t.prototype.query=function(t,e,n){this.getProxy().query(t,e,n)},t.prototype.groupBy=function(t,e,n,r,o){this.getProxy().groupBy(t,e,n,r,o)},t.prototype.createDataSet=function(t,e){var n=e||IdGenerators.TIMESTAMP;return new DataSet(this.getProxy(),t,n,this.getSynchronizer())},t}();